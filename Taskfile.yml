version: "3"

tasks:
  all:
    desc: Builds all templates
    deps:
      - versatile-apa
      - latex-reborn
      - acm-suite
      - upsa-bo
      - butterick
  versatile-apa:
    dir: versatile-apa
    cmds:
      - typst compile --root . template/main.typ
      - typst compile --root . template/main.typ thumbnail.png --pages 1
      - typst compile --root . template/student.typ thumbnail-student.png
      - typst compile --root . template/professional.typ thumbnail-professional.png
    desc: Versatile APA Template
    aliases:
      - apa
    sources:
      - "**/*.typ"
    generates:
      - "template/*.pdf"
      - "*.png"
  latex-reborn:
    aliases:
      - latex
    dir: latex-reborn
    cmds:
      - for: ["report", "article", "book", "letter"]
        cmd: typst compile --root . template/{{.ITEM}}.typ
      - for: ["report", "article", "book", "letter"]
        cmd: typst compile --root . template/{{.ITEM}}.typ thumbnail-{{.ITEM}}.png --pages 1
    sources:
      - "**/*.typ"
    generates:
      - "template/*.pdf"
  acm-suite:
    aliases:
      - acm
    dir: acm-suite
    cmds:
      - for: [
            "small",
            # TODO: Enable each one of these once they start to work.
            # "large",
            # "manuscript",
            # "sigpl",
            # "sig-conf",
            # "tog",
            # "cover-page",
            # "engage-cs-edu",
          ]
        cmd: typst compile --root . template/{{.ITEM}}.typ # Manuscript is default for thumbnails
  upsa-bo:
    dir: upsa-bo
    aliases:
      - upsa
    # watch: true
    sources:
      - "**/*.typ"
    generates:
      - "template/*.pdf"
    cmds:
      - for: ["Estudio de Factibilidad", "TFG"]
        cmd: typst compile --root . "template/{{.ITEM}}/{{.ITEM}}.typ"
  butterick:
    dir: butterick-resume
    sources:
      - "**/*.typ"
    generates:
      - "template/*.pdf"
      - "*.png"
    cmds:
      - typst compile --root . template/main.typ
      - typst compile --root . template/main.typ thumbnail.png --pages 1
